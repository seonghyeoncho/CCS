도커 이미지로 컨테이너를 생성하면 이미지는 읽기 전용이 되며 컨테이너의 변경 사항만 별로도 저장해서 각 컨테이너의 정보를 보존합니다.

이지 생성된 이미지는 어떠한 경우로도 변경되지 않으며, 컨테이너 계층에 원래 이미지에서 변경된 파일시스템 등을 저장합니다.

이미지에 mysql을 실행하는데 필요한 애플리케이션 파일이 들어있다면 컨테이너 계층에는 mysql을 운용하면서 쌓이는 데이터가 저장됩니다. 

*즉 해당 컨테이너를 삭제하면 컨테이너 계즟에 저장돼있던 데이터베이스의 정보도 삭제된다는 점입니다.*

이를 방지하기 위해 컨테이너릐 데이터를 영속적 데이터로 활용할 수 있는 방법이 있습니다. 그중 가장 활용하기 쉬운 방법으로 볼륨을 활용하는 것입니다.

볼륭르 사용하는 방법은 여러가지가 있습니다. 호스트 볼륨을 공유할 수도 있고, 볼륨 컨테이너를 활용할 수도 있으면, 도커가 관리하는 볼륨을 생성할 수도 있습니다. 도커가 괸라히는 볼륨을 생성할 수도 있습니다.

## 호스트 볼륨 공유

```s
docker run -d \
--name wordpressdb_hostvolume \
-e MYSQL_ROOT_PASSWORD=password \
-e MYSQL_DATABASE=wordpress \
-v /jome/wordpress_db:/var/lib/mysql \
mysql
```

```s
docker run -d \
-e WORDPRESS_DB_PASSWORD=password \
-e WORDPRESS_DB_HOST=mysql \
-e WORDPRESS_DB_USER=root \
--name wordpress_hostvolume \
--link eordpressdb_hostvolume:mysql \
-p 80 \
wordpress
```

`-v`
`[호스트의 공유 디렉토리]:[컨테이너의 공유 디렉토리]`

*컨테이너의 디렉토리는 호스트의 디렉토리와 동기화가 아니라 완전히 같은 디렉토리입니다.*

여러 개의 -v 옵션을 사용할 수도 있습니다.

## 볼륨 컨테이너

-v 옵션을 사용하는 컨테이너를 다른 컨테이너와 공유하는 방법입니다.

`--volumes-from` 옵션을 사용하면 -v 옵션을 적용한 컨테이너의 볼륨 디렉터리를 공유할 수 있습니다.

이는 직접 볼륨을 공유하는 것이 아닌 -v 옵션을 적용한 컨테이너를 통해 공유하는 것입니다.

이러한 구조를 활용하면 호스트에서 볼륨만 공유하고 ㄷ별도의 역할을 담당하지 않는 **볼륨 컨테이너**로서 활용할 수 있습니다.

## 도커 볼륨
`docker volume` 명령어를 사용하는 방법입니다. 도커 자체에서 제공하는 볼륨 기능입니다.

```s
docker volume crearte --name [name]
```

볼륨을 생성할 때 플러그인 드라이버를 설정해 여러 종류의 스토리지 백엔드를 쓸 수 있지만 그중 기본적으로 제공되는 드라이버인 local을 사용합니다. 이 볼륨은 로컬 호스트에 저장되며 도커 엔진에 의해 생성되고 삭제됩니다.

`-v [볼륨의 이름]:[컨테이너의 공유 디렉토리]`와 같이 입력합니다,

볼륨은 도커 엔진에서 관리합니다. 

docker inspect 명령어를 사용하면 볼륨이 실제로 어디에 존재하는지 알 수 있습니다.

```s
[
  {
    "Driver": "local",
    "Labels": {},
    "MountPoint": "/var/ilb/docker/volumes/myvolume/_data",
    "Name": "myvolume",
    "Options": {},
    "Scope": "local"
  }
]
```

`Driver`
볼륨을 쓰는 드라이버

`Label`
뵬륨을 구분하는 라벨

`MountPoint`
해당 볼륨이 실제로 호스트 어지에 저장됐는지 나타냅니다.

-v 옵션을 입력할 때 컨테이너에서 공유할 디렉토리의 위치를 입력하면 해당 디렉토리에 대한 볼륨을 자동으로 볼륨을 생성하도록 할 수 있습니다. 이때 볼륨을 이름은 무작위 16진수의 형태입니다.


`docker volume prune`볼륨 전체를 한꺼번에 삭제할 수 있습니다.

